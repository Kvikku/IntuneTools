<Page
    x:Class="IntuneTools.Pages.HomePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:IntuneTools.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
    <Grid>
        <ScrollViewer>
            <StackPanel Padding="40" Spacing="20">
                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="24">
                    <StackPanel Spacing="16">
                        <TextBlock Text="Welcome to InToolz"
                                   FontSize="48"
                                   FontWeight="Bold"
                                   HorizontalAlignment="Left"/>
                        <TextBlock TextWrapping="WrapWholeWords"
                                   FontSize="18"
                                   MaxWidth="1200"
                                   HorizontalAlignment="Left">
                            InToolz is a powerful application designed to help you manage and migrate your Microsoft Intune environment with ease.
                            This tool simplifies bulk management tasks, such as assignment, renaming, cleaning up and migrating Intune configurations between tenants.
                        </TextBlock>

                        <!-- Version status indicator with action buttons -->
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="8">
                            <Ellipse x:Name="VersionStatusIndicator" Width="12" Height="12" VerticalAlignment="Center">
                                <Ellipse.Fill>
                                    <SolidColorBrush x:Name="VersionStatusBrush" Color="Gray"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock x:Name="VersionStatusText"
                                       Text="Checking version..."
                                       FontSize="16"
                                       VerticalAlignment="Center"/>

                            <!-- Buttons shown only when update is available -->
                            <StackPanel Orientation="Horizontal" x:Name="UpdateButtonsPanel" Visibility="Collapsed" Spacing="6">
                                <Button x:Name="OpenGitHubButton"
                                        Content="Open GitHub"
                                        Click="OpenGitHubButton_Click"
                                        VerticalAlignment="Center"/>
                                <Button x:Name="OpenStoreButton"
                                        Content="Open in Store"
                                        Click="OpenStoreButton_Click"
                                        VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="20">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Connection Info" FontSize="28" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Tenant Name:" FontSize="18" VerticalAlignment="Center"/>
                            <TextBlock x:Name="TenantNameText" Text="Not Connected" FontSize="18" FontWeight="Bold" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            <Image x:Name="LoginStatusImage" Width="32" Height="32" VerticalAlignment="Center" Margin="10,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="20">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Time Saved (Estimate)" FontSize="28" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="12">
                            <TextBlock x:Name="TimeSavedMinutesText"
                                       Text="0"
                                       FontSize="48"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="minutes saved"
                                       FontSize="18"
                                       VerticalAlignment="Center"/>
                        </StackPanel>
                        <ProgressBar x:Name="TimeSavedProgress"
                                     Height="10"
                                     Minimum="0"
                                     Maximum="1000"
                                     Value="0"/>
                        <TextBlock Text="This overview is an estimate based on recorded actions and typical manual completion times. Actual time saved may vary."
                                   TextWrapping="WrapWholeWords"
                                   FontSize="14"
                                   Opacity="0.75"/>

                        <StackPanel x:Name="TimeSavedBreakdownPanel" Spacing="6" Visibility="Collapsed">
                            <TextBlock Text="Activity breakdown" FontSize="16" FontWeight="SemiBold"/>
                            <StackPanel x:Name="RenamedItemsPanel" Orientation="Horizontal" Spacing="8" Visibility="Collapsed">
                                <TextBlock x:Name="RenamedItemsCountText" Text="0" FontWeight="SemiBold"/>
                                <TextBlock Text="items renamed / descriptions updated"/>
                            </StackPanel>
                            <StackPanel x:Name="AssignedItemsPanel" Orientation="Horizontal" Spacing="8" Visibility="Collapsed">
                                <TextBlock x:Name="AssignedItemsCountText" Text="0" FontWeight="SemiBold"/>
                                <TextBlock Text="items assigned"/>
                            </StackPanel>
                            <StackPanel x:Name="DeletedItemsPanel" Orientation="Horizontal" Spacing="8" Visibility="Collapsed">
                                <TextBlock x:Name="DeletedItemsCountText" Text="0" FontWeight="SemiBold"/>
                                <TextBlock Text="items deleted"/>
                            </StackPanel>
                            <StackPanel x:Name="ImportedItemsPanel" Orientation="Horizontal" Spacing="8" Visibility="Collapsed">
                                <TextBlock x:Name="ImportedItemsCountText" Text="0" FontWeight="SemiBold"/>
                                <TextBlock Text="items imported"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="20">
                    <StackPanel Spacing="8">
                        <TextBlock Text="Key Features" FontSize="28" FontWeight="SemiBold"/>
                        <TextBlock Text="-  Export and Import of Intune content between tenants." FontSize="16"/>
                        <TextBlock Text="-  Manage assignment of Intune content in bulk." FontSize="16"/>
                        <TextBlock Text="-  Clean up policies, scripts, and profiles in bulk." FontSize="16"/>
                        <TextBlock Text="-  Rename Intune objects with customizable prefixes." FontSize="16"/>
                    </StackPanel>
                </Border>

                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="20">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Documentation" FontSize="28" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="For more details on how to use the application, please refer to our documentation on GitHub." TextWrapping="Wrap" VerticalAlignment="Center"/>
                            <HyperlinkButton x:Name="GitHubLink" Content="View on GitHub" NavigateUri="https://github.com/Kvikku/IntuneTools" Click="GitHubLink_Click" />
                        </StackPanel>
                    </StackPanel>
                </Border>

                <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="20">
                    <StackPanel Spacing="10">
                        <TextBlock Text="Feedback and Issues" FontSize="28" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="Encountered a bug or have a feature request? Please submit it on our GitHub issues page." TextWrapping="Wrap" VerticalAlignment="Center"/>
                            <HyperlinkButton x:Name="GitHubIssuesLink" Content="Submit Feedback" NavigateUri="https://github.com/Kvikku/IntuneTools/issues" Click="GitHubLink_Click" />
                        </StackPanel>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>
